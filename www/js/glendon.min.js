function startApp(e){$("#spinnerHome").addClass("fa-spin");var t=getPageName(),i=window.localStorage.getItem("offLine");getStrings(),1==i?(getCurrentDate(),navPills(),getTimeTableLink(),"subcategories"==t&&subCategories(),"pagelist"==t&&pageList(),"details"==t&&detailsPage(),"events"==t&&eventsPage(),"favorites"==t&&getMyFavorites()):(getSite(e),getTimeTableLink(),"GlendonApp"==t&&(getCurrentDate(),initSlider(),getWeather(),getAnnouncements(),navPills(),route124East(),route124West(),route11South(),route11North(),getGlendonShuttle(),getKeeleShuttle(),setInterval(function(){route124East(),route124West(),route11South(),route11North(),getGlendonShuttle(),getKeeleShuttle()},6e4),setInterval(function(){getAnnouncementsRefresh()},5e3),setInterval(function(){getWeather()},36e5),setInterval(function(){getCurrentDate()},36e5),setInterval(function(){$("#spinnerHome").removeClass("fa-spin")},2e3)),"subcategories"==t&&subCategories(),"pagelist"==t&&pageList(),"details"==t&&detailsPage(),"events"==t&&eventsPage(),"favorites"==t&&getMyFavorites(),"Contact"==t&&(getCurrentDate(),getWeather()))}function initSlider(){function e(e){var a=-100*e-100+"%";t.animate({"margin-left":a},400,function(){e<0?(t.css("margin-left",-100*i+"%"),e=i-1):e>=i&&(t.css("margin-left","-100%"),e=0),n=e})}var t=$(".slider ul"),i=t.children().length,a=100/i,n=0,r=t.find("li:first-child");t.find("li:last-child").clone().prependTo(t),r.clone().appendTo(t),t.find("li").each(function(e){var t=a*e+"%";$(this).css({left:t}),$(this).css({width:100/i+"%"})}),t.css("margin-left","-100%"),$(".slider .prev").click(function(){e(n-1)}),$(".slider .next").click(function(){e(n+1)})}function navPills(){var e=new Language(window.localStorage.getItem("lang")),t="";0==window.localStorage.getItem("offLine")?(t+='<li class="active"><a data-toggle="tab" href="#shuttleTab"><i class="fa fa-bus" aria-hidden="true"></i>'+e.getString("shuttle")+"</a></li>",t+='<li><a data-toggle="tab" href="#ttcTab"><i class="fa fa-subway" aria-hidden="true"></i>TTC</a></li>',t+='<a href="javascript:void(0);" onClick="startApp(\'1\')"><i id="spinnerHome" class="fa fa-refresh fa-spin refresh-icon" aria-hidden="true"></i></a>'):t="fr"==window.localStorage.getItem("lang")?'<li class="active"><a href="javascript:void(0);"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i><span id="currentlyOffLine">Hors ligne</span></a></li>':'<li class="active"><a href="javascript:void(0);"><i class="fa fa-exclamation-triangle" aria-hidden="true"></i><span id="currentlyOffLine">Currently offline</span></a></li>',$(".blue-title").html(t)}function isOnline(){return!!navigator.onLine}function Language(lang){var __construct=function(){"undefined"==eval("typeof "+lang)&&(lang="en")}();this.getString=function(str,defaultStr){var retStr=eval("eval(lang)."+str);return void 0!==retStr?retStr:void 0!==defaultStr?defaultStr:eval("en."+str)}}function getLanguage(){var e=window.localStorage.getItem("lang");return null==e&&(window.localStorage.setItem("lang","fr"),e="fr"),e}function getStrings(){var e=new Language($("#lang").val());$("#home").html(e.getString("home")),$("#about").html(e.getString("about")),$("#contact").html(e.getString("contact")),$("#myTimeTable").html(e.getString("myTimeTable")),$("#abbreviatedLang").html(e.getString("abbreviatedLang")),$("#shuttle").html(e.getString("shuttle")),$("#currentlyOffLine").html(e.getString("currentlyOffLine")),$("#mon").html(e.getString("mon")),$("#tue").html(e.getString("tue")),$("#wed").html(e.getString("wed")),$("#thu").html(e.getString("thu")),$("#fri").html(e.getString("fri")),$("#fall").html(e.getString("fall")),$("#winter").html(e.getString("winter")),$("#summer").html(e.getString("summer")),$("#userName").html(e.getString("userName")),$("#password").html(e.getString("password")),$("#login").html(e.getString("login")),$("#uid").attr("placeholder",e.getString("userName")),$("#pwd").attr("placeholder",e.getString("password")),$("#loginInstructions").html(e.getString("loginInstructions")),$("#directory").html(e.getString("directory")),$("#lastName").html(e.getString("lastName")),$("#firstName").html(e.getString("firstName")),$("#emailText").html(e.getString("email")),$("#serviceprovided").html(e.getString("title")),$("#extension").html(e.getString("extension")),$("#ln").attr("placeholder",e.getString("lastName")),$("#fn").attr("placeholder",e.getString("firstName")),$("#email").attr("placeholder",e.getString("email")),$("#dep").attr("placeholder",e.getString("department")),$("#directoryHeader").html(e.getString("directory")),$("#addToCalendar").html(e.getString("addToCalendar")),$("#lifeThreatening").html(e.getString("lifeThreatening")),$("#urgentCampusMatters").html(e.getString("urgentCampusMatters")),$("#ysGeneral").html(e.getString("ysGeneral")),$("#ysTTY").html(e.getString("ysTTY")),$("#ysUrgent").html(e.getString("ysUrgent")),$("#goSAFE").html(e.getString("goSAFE")),$("#good2Talk").html(e.getString("good2Talk")),$("#lostFound").html(e.getString("lostFound")),$("#SASSL").html(e.getString("SASSL"))}function getTimeTableLink(){switch((new Date).getMonth()){case 0:case 1:case 2:case 3:$("#timeTable").attr("href","winter.html");break;case 4:case 5:case 6:case 7:case 8:$("#timeTable").attr("href","summer.html");break;case 9:case 10:case 11:$("#timeTable").attr("href","fall.html")}}function route124East(){0==window.localStorage.getItem("offLine")&&$.ajax({type:"GET",url:"http://webservices.nextbus.com/service/publicJSONFeed?command=predictions&a=ttc&stopId=1220&r=124",crossDomain:!0,dataType:"json",success:function(e){if("en"==$("#lang").val()){$(".route124Title").html(e.predictions.routeTitle),$("#route124East .title").html(e.predictions.direction.title),$("#route124East .stopTitle").html(e.predictions.stopTitle);i=t=e.predictions.direction.prediction[0].minutes;0===t&&(i="Arriving ")}else{$(".route124Title").html(e.predictions.routeTitle),$("#route124East .title").html("Est - 124 Sunnybrook vers l'hôpital de Sunnybrook"),$("#route124East .stopTitle").html("Lawrence ave est à Bayview Ave");var t=e.predictions.direction.prediction[0].minutes,i=t;0===t&&(i="Arrivé ")}$("#route124East .minutes0").html(i),$("#route124East .minutes1").html(e.predictions.direction.prediction[1].minutes),void 0!=e.predictions.direction.prediction[2].minutes&&$("#route124East .minutes2").html(e.predictions.direction.prediction[2].minutes)}})}function route124West(){0==window.localStorage.getItem("offLine")&&$.ajax({url:"http://webservices.nextbus.com/service/publicJSONFeed?command=predictions&a=ttc&stopId=1726&r=124",crossDomain:!0,dataType:"json",success:function(e){if("en"==$("#lang").val()){$(".to").html("To:"),$(".stop").html("Stop:"),$(".route124Title").html(e.predictions.routeTitle),$("#route124West .title").html(e.predictions.direction.title),$("#route124West .stopTitle").html(e.predictions.stopTitle);i=t=e.predictions.direction.prediction[0].minutes;0===t&&(i="Arriving ")}else{$(".to").html("Vers:"),$(".stop").html("Arrêt:"),$(".route124Title").html(e.predictions.routeTitle),$("#route124West .title").html("Ouest - 124 Sunnybrook vers la gare de Lawrence"),$("#route124West .stopTitle").html("Bayview ave à Lawrence ave est (Campus Glendon York U)");var t=e.predictions.direction.prediction[0].minutes,i=t;0==t&&(i="Arrivé ")}$("#route124West .minutes0").html(i),$("#route124West .minutes1").html(e.predictions.direction.prediction[1].minutes),void 0!=e.predictions.direction.prediction[2].minutes&&$("#route124West .minutes2").html(e.predictions.direction.prediction[2].minutes)}})}function route11South(){0==window.localStorage.getItem("offLine")&&$.ajax({url:"http://webservices.nextbus.com/service/publicJSONFeed?command=predictions&a=ttc&stopId=11330&r=11",crossDomain:!0,dataType:"json",success:function(e){if("en"==$("#lang").val()){$(".route11Title").html(e.predictions.routeTitle),$("#route11South .title").html(e.predictions.direction.title),$("#route11South .stopTitle").html(e.predictions.stopTitle);i=t=e.predictions.direction.prediction[0].minutes;0==t&&(i="Arriving ")}else{$(".route11Title").html(e.predictions.routeTitle),$("#route11South .title").html("Sud - 11 Bayview vers Davisville Station via Sunnybrook"),$("#route11South .stopTitle").html("Bayview ave à Lawrence ave est (Campus Glendon York U)");var t=e.predictions.direction.prediction[0].minutes,i=t;0==t&&(i="Arrivé ")}$("#route11South .minutes0").html(i),$("#route11South .minutes1").html(e.predictions.direction.prediction[1].minutes),void 0!=e.predictions.direction.prediction[2].minutes&&$("#route11South .minutes2").html(e.predictions.direction.prediction[2].minutes)}})}function route11North(){0==window.localStorage.getItem("offLine")&&$.ajax({url:"http://webservices.nextbus.com/service/publicJSONFeed?command=predictions&a=ttc&stopId=1726&r=11",crossDomain:!0,dataType:"json",success:function(e){if("en"==$("#lang").val()){$(".route11Title").html(e.predictions.routeTitle),$("#route11North .title").html(e.predictions.direction.title),$("#route11North .stopTitle").html(e.predictions.stopTitle);i=t=e.predictions.direction.prediction[0].minutes;0==t&&(i="Arriving ")}else{$(".route11Title").html(e.predictions.routeTitle),$("#route11North .title").html("Nord - 11 Bayview vers Steeles via Sunnybrook"),$("#route11North .stopTitle").html("Bayview ave à Lawrence ave est (Campus Glendon York U)");var t=e.predictions.direction.prediction[0].minutes,i=t;0==t&&(i="Arriving ")}$("#route11North .minutes0").html(i),$("#route11North .minutes1").html(e.predictions.direction.prediction[1].minutes),void 0!=e.predictions.direction.prediction[2].minutes&&$("#route11North .minutes2").html(e.predictions.direction.prediction[2].minutes)}})}function getGlendonShuttle(){var e=window.localStorage.getItem("offLine"),t=new Language(getLanguage());if(0==e){var a=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_shuttle&campus=glendon&moodlewsrestformat=json";$.ajax({url:a,crossDomain:!0,dataType:"json",success:function(e){var a="";if("en"==$("#lang").val())if(1==e.length&&0==e[0].campus)a='<div class="alert alert-warning" >No shuttle available at this time.</div>';else for(i=0;i<e.length;i++){if(""!=e[i].remaininghour)r=e[i].remaininghour+" hour(s) "+e[i].remainingminutes+" minute(s)";else if(0!=e[i].remainingminutes)r=e[i].remainingminutes+" minute(s)";else r="Leaving";a+="<li>",a+='\t<div id="bus-time">',a+=r;var n=e[i].departureminute;if(a+='\t\t<br/><span class="bus-time-span">'+e[i].departurehour+":"+n+"</span>",a+="\t</div>",a+='\t<div id="direction">',a+='\t\t<span id="destination-indicator">Glendon York Hall<br/>'+t.getString("towards")+" Keele Vari Hall</span>",a+="\t</div>",a+="</li>",3==i)break}else if(1==e.length&&0==e[0].campus)a='<div class="alert alert-warning">Pas de navette disponible pour le moment.</div>';else for(i=0;i<e.length;i++){if(""!=e[i].remaininghour)r=e[i].remaininghour+" h "+e[i].remainingminutes+" min";else if(0!=e[i].remainingminutes)r=e[i].remainingminutes+" min";else var r="Départ";if(a+="<li>",a+='\t<div id="bus-time">',a+=r,a+='\t\t<br/><span class="bus-time-span">'+e[i].departurehour+" h "+e[i].departureminute+"</span>",a+="\t</div>",a+='\t<div id="direction">',a+='\t\t<span id="destination-indicator">Glendon York Hall<br/>'+t.getString("towards")+" Keele Vari Hall</span>",a+="\t</div>",a+="</li>",3==i)break}$(".to-keele").html(a)}})}}function getKeeleShuttle(){var e=window.localStorage.getItem("offLine"),t=new Language(getLanguage());if(0==e){var a=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_shuttle&campus=keele&moodlewsrestformat=json";$.ajax({url:a,crossDomain:!0,dataType:"json",success:function(e){var a="";if("en"==$("#lang").val())if(1==e.length&&0==e[0].campus)a='<div class="alert alert-warning" >No shuttle available at this time.</div>';else for(i=0;i<e.length;i++){if(""!=e[i].remaininghour)n=e[i].remaininghour+" hour(s) "+e[i].remainingminutes+" minute(s)";else if(0!=e[i].remainingminutes)n=e[i].remainingminutes+" min";else n="Leaving";if(a+="<li>",a+='\t<div id="bus-time">',a+=n,a+='\t\t<br/><span class="bus-time-span">'+e[i].departurehour+":"+e[i].departureminute+"</span>",a+="\t</div>",a+='\t<div id="direction">',a+='\t\t<span id="destination-indicator">Keele Vari Hall<br/>'+t.getString("towards")+" Glendon York Hall</span>",a+="\t</div>",a+="</li>",3==i)break}else if(1==e.length&&0==e[0].campus)a='<div class="alert alert-warning">Pas de navette disponible pour le moment.</div>';else for(i=0;i<e.length;i++){if(""!=e[i].remaininghour)n=e[i].remaininghour+" h "+e[i].remainingminutes+" min";else if(0!=e[i].remainingminutes)n=e[i].remainingminutes+" min";else var n="Départ";if(a+="<li>",a+='\t<div id="bus-time">',a+=n,a+='\t\t<br/><span class="bus-time-span">'+e[i].departurehour+" h "+e[i].departureminute+"</span>",a+="\t</div>",a+='\t<div id="direction">',a+='\t\t<span id="destination-indicator">Keele Vari Hall<br/>'+t.getString("towards")+" Glendon York Halll</span>",a+="\t</div>",a+="</li>",3==i)break}$(".to-glendon").html(a)}})}}function getWeather(){if(0==window.localStorage.getItem("offLine")){var e=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_weather&retrieve=1&moodlewsrestformat=json";$.ajax({url:e,crossDomain:!0,dataType:"json",success:function(e){"en"==$("#lang").val()?($("#temperature").html(e[0].temperature_en),$("#condition").html(e[0].condition_en)):($("#temperature").html(e[0].temperature_fr),$("#condition").html(e[0].condition_fr)),$(".meteo-icon").addClass(e[0].icon)}})}}function getCurrentDate(){var e=new Date,t=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],a=(("0"+(e.getMonth()+1)).slice(-2),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),n=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],r=("0"+e.getDate()).slice(-2),o=e.getFullYear(),l="",s="";"en"==$("#lang").val()?(l=a[e.getDay()],s=t[e.getMonth()]+r+", "+o):(l=n[e.getDay()],s=r+" "+i[e.getMonth()]+", "+o),$("#dayName").html(l),$("#currentDate").html(s)}function getDateInfo(e){var t=new Date(e),i=["January","February","March","April","May","June","July","August","September","October","November","December"],a=["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],n=(("0"+(t.getMonth()+1)).slice(-2),["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),r=["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],o=("0"+t.getDate()).slice(-2),l=t.getFullYear();return{day:o,year:l,dayNameEn:n[t.getDay()],currentDateEn:i[t.getMonth()]+o+", "+l,dayNameFr:r[t.getDay()],currentDateFr:o+" "+a[t.getMonth()]+", "+l,timeFr:t.getHours()+"h"+t.getMinutes(),timeEn:t.getHours()+":"+t.getMinutes()}}function getAnnouncements(){if(0==window.localStorage.getItem("offLine")){var e=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_announcements&retrieve=1&moodlewsrestformat=json";$.ajax({url:e,crossDomain:!0,dataType:"json",success:function(e){var t=new Date,a=t.getYear()+t.getMonth()+t.getDay();if(e.length>0&&(""!=e[0].liFr||""!=e[0].liEn)){var n='<div class="announcements">\r';for(n+="\x3c!--"+a+"--\x3e",n+='   <div class="slider">\r',n+="       <ul>\r",i=0;i<e.length;i++)"en"==$("#lang").val()?n+=e[i].liEn:n+=e[i].liFr;n+="       </ul>\r",n+='       <button class="prev"><i class="fa fa-chevron-left" aria-hidden="true"></i></button>\r',n+='       <button class="next"><i class="fa fa-chevron-right" aria-hidden="true"></i></button>\r',n+="   </div>\r";var r=n+="</div>\r";window.localStorage.setItem("announcementCode",r),$("#announcementsContent").html(n);var o=100*e.length;$(".slider ul").css("width",o+"%");var l=100/e.length;$(".slider li").css("width",l+"%"),initSlider()}}})}}function getAnnouncementsRefresh(){if(0==window.localStorage.getItem("offLine")){var e=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_announcements&retrieve=1&moodlewsrestformat=json";$.ajax({url:e,crossDomain:!0,dataType:"json",success:function(e){var t=new Date,a=t.getYear()+t.getMonth()+t.getDay();if(e.length>0&&(""!=e[0].liFr||""!=e[0].liEn)){var n='<div class="announcements">\r';for(n+="\x3c!--"+a+"--\x3e",n+='   <div class="slider">\r',n+="       <ul>\r",i=0;i<e.length;i++)"en"==$("#lang").val()?n+=e[i].liEn:n+=e[i].liFr;n+="       </ul>\r",n+='       <button class="prev"><i class="fa fa-chevron-left" aria-hidden="true"></i></button>\r',n+='       <button class="next"><i class="fa fa-chevron-right" aria-hidden="true"></i></button>\r',n+="   </div>\r";var r=n+="</div>\r";if(window.localStorage.getItem("announcementCode")!=r){window.localStorage.setItem("announcementCode",r),$("#announcementsContent").html(n);var o=100*e.length;$(".slider ul").css("width",o+"%");var l=100/e.length;$(".slider li").css("width",l+"%"),initSlider()}}else $(".announcements").remove()}})}}function getMyFavorites(){var e=getLanguage(),t=new Language(e),a=window.localStorage.getItem("favorites");if(""!==a&&null!==a){var n=JSON.parse(a),r="<ul>";if(null!=n)for(i=0;i<n.length;i++)r+='<li class="menu-section">',r+='<i class="fa fa-angle-right sub-menu-arrow" aria-hidden="true"></i>',r+='<a href="'+n[i].url+'">'+n[i].name+"</a>",r+="</li>";r+="</ul>",$("#favorites").html(r)}$("#myFavorites").html(t.getString("myFavorites"))}function addToFavorites(){var e=getLanguage(),t=(new Language(e),$("#id").val()),i=$("#name").val(),a=$("#url").val(),n=$("#favoriteIcon").attr("data-id"),r=window.localStorage.getItem("favorites");if(""==r||null==r)o=[{id:parseInt(t),name:i,url:a}];else{var o=JSON.parse(r);o.push({id:parseInt(t),name:i,url:a})}var l=JSON.stringify(o);window.localStorage.setItem("favorites",l),-1==n?($("#favoriteIcon").attr("style","color:#E31836"),"en"==e?$.notify({message:"Favorite added"},{element:"body",position:null,type:"success",delay:1e3}):$.notify({message:"Favoris ajouté"},{element:"body",position:null,type:"success",delay:1e3}),$("#favoriteIcon").attr("data-id",t)):(deleteFavorite(n),$("#favoriteIcon").attr("data-id",-1))}function deleteFavorite(e){e=parseInt(e);var t=window.localStorage.getItem("favorites"),i=JSON.parse(t);items=$.grep(i,function(t){return t.id!==e});var a=JSON.stringify(items);return localStorage.setItem("favorites",a),$("#favoriteIcon").attr("style","color:rgba(15, 44, 91, 0.3)"),getMyFavorites()}function getSite(e){var t=window.localStorage.getItem("offLine"),i=new Date,a=i.getFullYear()+"-"+i.getMonth()+"-"+i.getDate(),n=window.localStorage.getItem("siteVersion");if(0==t&&(1==e||null==n||n!=a)){var r=config.webServiceUrl+"wstoken="+config.webServiceToken+"&wsfunction=local_webapp_site&retrieve=1&moodlewsrestformat=json";$.ajax({url:r,crossDomain:!0,dataType:"json",success:function(e){var t=window.localStorage.getItem("siteCode");if(null==t){i=e[0].site;window.localStorage.setItem("siteCode",i)}else if(t!=e[0].site){var i=t=e[0].site;window.localStorage.setItem("siteCode",i)}JSON.parse(i);n=window.localStorage.setItem("siteVersion",a),n=a}})}}function subCategories(){var e=$("#cId").val();""==e&&(e=getUrlVars().id,$("#cId").val(e));var t=window.localStorage.getItem("siteCode"),a=JSON.parse(t).categories[e].subcategories,n="<ul>";for(i=0;i<a.count;i++)"en"==$("#lang").val()?(n+='<li class="menu-section">',n+='    <i class="fa fa-angle-right sub-menu-arrow" aria-hidden="true"></i>',n+='    <a href="pagelist.html?cid='+e+"&scid="+i+'">'+a[i].nameEn+"</a>",n+="</li>"):(n+='<li class="menu-section">',n+='    <i class="fa fa-angle-right sub-menu-arrow" aria-hidden="true"></i>',n+='    <a href="pagelist.html?cid='+e+"&scid="+i+'">'+a[i].nameFr+"</a>",n+="</li>");n+="</ul>",$("#subCategories").html(n)}function pageList(){var e=$("#cId").val(),t=$("#scId").val();""==e&&(e=getUrlVars().cid,$("#cId").val(e)),""==t&&(t=getUrlVars().scid,$("#scId").val(t));var a=window.localStorage.getItem("siteCode"),n=JSON.parse(a).categories[e].subcategories[t].listing,r=!1,o="<ul>",l=JSON.parse(window.localStorage.getItem("favorites"));for(i=0;i<n.count;i++){if(""!=n[i].externalUrlEn||""!=n[i].externalUrlFr){var s=n[i].externalUrlEn,c=n[i].externalUrlFr;""==c&&(c=s),""==s&&(s=c),r=!1}null!==l&&(1==$.grep(l,function(e){return e.id==n[i].id}).length?'style="color:#E31836"':""),"en"==$("#lang").val()?(o+='<li class="menu-section-listing">',o+=1==r?'    <a href="'+s+'" target="_blank">'+n[i].nameEn+"</a>":'    <a href="details.html?cid='+e+"&scid="+t+"&listid="+i+"&pid="+n[i].id+'">'+n[i].nameEn+"</a>",o+="</li>"):(o+='<li class="menu-section-listing">',o+=1==r?'    <a href="'+s+'" target="_blank">'+n[i].nameEn+"</a>":'    <a href="details.html?cid='+e+"&scid="+t+"&listid="+i+"&pid="+n[i].id+'">'+n[i].nameFr+"</a>",o+="</li>")}o+="</ul>",$("#pageList").html(o),$(".site-wrap").swipe({allowPageScroll:"vertical",swipe:function(t,i,a,n,r,o){"right"==i&&(window.location="subcategories.html?id="+e)}}),$("#return-back-link").attr("href","subcategories.html?id="+e)}function detailsPage(){var t=window.localStorage.getItem("offLine"),a=new Language($("#lang").val()),n=$("#cId").val(),r=$("#scId").val(),o=$("#listId").val(),l=$("#pId").val();""==n&&(n=getUrlVars().cid,$("#cId").val(n)),""==r&&(r=getUrlVars().scid,$("#scId").val(r)),""==o&&(o=getUrlVars().listid,$("#listId").val(o)),""==l&&(l=getUrlVars().pid,$("#pId").val(l));var s=new Date,c=s.getFullYear()+""+s.getMonth()+s.getDate(),d=(s.getDay(),Array()),g=JSON.parse(window.localStorage.getItem("favorites"));null!==g?1==$.grep(g,function(e){return e.id==l}).length?($("#favoriteIcon").attr("style","color:#E31836"),$("#favoriteIcon").attr("data-id",l),$("#favoriteIcon").attr("onclick","addToFavorites("+l+")")):("",$("#favoriteIcon").attr("onclick","addToFavorites("+l+")"),$("#favoriteIcon").attr("style","color:#E4E4E4"),$("#favoriteIcon").attr("data-id",-1)):($("#favoriteIcon").attr("onclick","addToFavorites("+l+")"),$("#favoriteIcon").attr("style","color:#E4E4E4"),$("#favoriteIcon").attr("data-id",-1));var u=window.localStorage.getItem("siteCode"),m=JSON.parse(u),h=m.categories[n].subcategories[r].listing[o],f=m.categories[n].subcategories[r].listing[o].events,v='<ul class="default_list">';if($("#url").val("details.html?cid="+n+"&scid="+r+"&listid="+o+"&pid="+l),$("#id").val(l),$("#search").attr("placeholder",a.getString("refineList")),"en"==$("#lang").val()){for($(".location-name").html(h.nameEn),$("#description").html(h.descriptionEn),1==t||""==h.imageEn?($("#location-image").attr("src","img/transparent.png"),$("#location-image").attr("style","width: 0px; height:0px;")):$("#location-image").attr("src",h.imageEn),$("#location-email").html(h.email),""!=h.externalUrlEn&&$("#externalUrl").html('<a href="'+h.externalUrlEn+'"><i class="fa fa-globe  contact-info-icon" aria-hidden="true"></i></a>'),e=0;e<f.count;e++){var p=(S=new Date(f[e].startDateTime)).getFullYear()+""+S.getMonth()+S.getDate(),w=S.getDay(),S=getDateInfo(f[e].startTimeEn);switch(f.type){case 1:$("#eventsTitle").html(a.getString("eventTitle")),p>=c&&(v+='    <li class="location-event-listing">',v+='    <a href="events.html?cid='+n+"&scid="+r+"&listid="+o+"&pid="+l+"&eid="+e+'"><i class="fa fa-angle-right event-arrow" aria-hidden="true"></i>',v+="    <span>"+f[e].nameEn+"</span><br/>Where: "+f[e].locationEn+"<br/>",v+="    When: "+S.currentDateEn+" | @ "+S.timeEn+"</a>",v+="    </li>");break;case 2:$("#eventsTitle").html(a.getString("eventTitle")),p==c&&(v+='    <li class="location-event-listing">',v+='    <a href="events.html?cid='+n+"&scid="+r+"&listid="+o+"&pid="+l+"&eid="+e+'"><i class="fa fa-angle-right event-arrow" aria-hidden="true"></i>',v+="    <span>"+f[e].nameEn+"</span><br/>Where: "+f[e].locationEn+"<br/>",v+="    When: "+S.currentDateEn+" | @ "+S.timeEn+"</a>",v+="    </li>",d[e]=w+"-"+f[e].nameEn);break;case 3:$("#eventsTitle").html(a.getString("dailySpecials"));var b=JSON.parse(f[e].operationHours),y="",T="",I=JSON.parse(f[e].days),E=s.getDay();for(i=0;i<b.length;i++)b[i].day==E&&(y=b[i].openingHour,T=b[i].closingHour);s.getHours(),s.getMinutes();F='<h1 class="hours-operation-title">Store hours</h1>';F+='<h1 class="operation-schedule">'+y+" to "+T+"</h1>",$("#storeHours").html(F),$.inArray(E,I)&&(v+='    <li class = "food-menu-item"> ',1!=t&&""==f[e].imageEn||(v+='    <img style="float: left; margin: 0px 15px 15px 0px;" src="'+f[e].imageEn+'" class="img-responsive" height="42" width="42">'),v+="    <span>$"+f[e].price+" // "+f[e].nameEn+'</span><br style="clear:both" />'+f[e].descriptionEn,v+="    </li>")}}v+="</ul>",$("#name").val(h.nameEn),console.log(d)}else{for($(".location-name").html(h.nameFr),$("#description").html(h.descriptionFr),1==t||""==h.imageFr?($("#location-image").attr("src","img/transparent.png"),$("#location-image").attr("style","width: 0px; height:0px;")):$("#location-image").attr("src",h.imageFr),$("#location-email").html(h.email),""!=h.externalUrlFr&&$("#externalUrl").html('<a href="'+h.externalUrlFr+'"><i class="fa fa-globe  contact-info-icon" aria-hidden="true"></i></a>'),e=0;e<f.count;e++){var p=(S=new Date(f[e].startDateTime)).getFullYear()+""+S.getMonth()+S.getDate(),w=S.getDay(),S=getDateInfo(f[e].startTimeEn);switch(f.type){case 1:$("#eventsTitle").html(a.getString("eventTitle")),p>=c&&(v+='    <li class="location-event-listing">',v+='    <a href="events.html?cid='+n+"&scid="+r+"&listid="+o+"&pid="+l+"&eid="+e+'"><i class="fa fa-angle-right event-arrow" aria-hidden="true"></i>',v+="    <span>"+f[e].nameFr+"</span><br/>Ou: "+f[e].locationFr+"<br/>",v+="    Quand: "+S.currentDateFr+" | @ "+S.timeFr+"</a>",v+="    </li>");break;case 2:$("#eventsTitle").html(a.getString("eventTitle")),p==c&&(v+='    <li class="location-event-listing">',v+='    <a href="events.html?cid='+n+"&scid="+r+"&listid="+o+"&pid="+l+"&eid="+e+'"><i class="fa fa-angle-right event-arrow" aria-hidden="true"></i>',v+="    <span>"+f[e].nameFr+"</span><br/>Ou: "+f[e].locationFr+"<br/>",v+="    Quand: "+S.currentDateFr+" | @ "+S.timeFr+"</a>",v+="    </li>");break;case 3:$("#eventsTitle").html(a.getString("dailySpecials"));var b=JSON.parse(f[e].operationHours),y="",T="",I=JSON.parse(f[e].days),E=s.getDay();for(i=0;i<b.length;i++)b[i].day==E&&(y=b[i].openingHour,T=b[i].closingHour);s.getHours(),s.getMinutes();var F='<h1 class="hours-operation-title">Heures d\'ouvertures</h1>';F+='<h1 class="operation-schedule">'+y+" à "+T+"</h1>",$("#storeHours").html(F),$.inArray(E,I)&&(v+='    <li class = "food-menu-item"> ',1!=t&&""==f[e].imageFr||(v+='    <img style="float: left; margin: 0px 15px 15px 0px;" src="'+f[e].imageFr+'" class="img-responsive" height="42" width="42">'),v+="    <span>"+f[e].price+"$ // "+f[e].nameFr+'</span><br style="clear:both" />'+f[e].descriptionFr,v+="    </li>")}}v+="</ul>",$("#name").val(h.nameFr)}$("#eventsList").html(v),""!=h.instagram&&$("#instagram").html('<a href="'+h.instagram+'"><i class="fa fa-instagram  contact-info-icon" aria-hidden="true"></i></a>'),""!=h.facebook&&$("#facebook").html('<a href="'+h.facebook+'"><i class="fa fa-facebook-square  contact-info-icon" aria-hidden="true"></i></a>'),""!=h.twitter&&$("#twitter").html('<a href="'+h.twitter+'"><i class="fa fa-twitter-square  contact-info-icon" aria-hidden="true"></i></a>'),$(".site-wrap").swipe({allowPageScroll:"vertical",swipe:function(e,t,i,a,o,l){"right"==t&&(window.location="pagelist.html?cid="+n+"&scid="+r)}}),$("#return-back-link").attr("href","pagelist.html?cid="+n+"&scid="+r),$("#search").hideseek()}function eventsPage(){var e=window.localStorage.getItem("offLine"),t=getLanguage(),i=new Language(t),a=$("#cId").val(),n=$("#scId").val(),r=$("#listId").val(),o=$("#pId").val(),l=$("#eId").val();""==a&&(a=getUrlVars().cid,$("#cId").val(a)),""==n&&(n=getUrlVars().scid,$("#scId").val(n)),""==r&&(r=getUrlVars().listid,$("#listId").val(r)),""==o&&(o=getUrlVars().pid,$("#pId").val(o)),""==l&&(l=getUrlVars().eid,$("#eId").val(l));var s=localStorage.getItem("siteCode"),c=JSON.parse(s).categories[a].subcategories[n].listing[r].events[l];$("#where").html(i.getString("where")),$("#when").html(i.getString("when")),$("#description").html(i.getString("description"));var d=getDateInfo(c.startTimeEn);"en"==t?($("#eventTitle").html(c.nameEn),$(".event-description").html(c.descriptionEn),1==e||""==c.imageEn?($("#location-image").attr("src","img/transparent.png"),$("#location-image").attr("style","width: 0px; height:0px;")):$("#location-image").attr("src",c.imageEn),$(".location-name").html(c.locationEn),$("#location-email").html(c.email),$(".event-date-time").html(d.currentDateEn+" | @ "+d.timeEn),$(".add-to-calendar").click(function(){var e=new Date(c.startDateTime),t=new Date(c.endDateTime),i=c.nameEn,a=c.locationEn,n=c.descriptionEn;window.plugins.calendar.createEventInteractively(i,a,n,e,t,function(e){alert("Success: "+JSON.stringify(e))},function(e){alert("Error: "+e)})})):($("#eventTitle").html(c.nameFr),$(".event-description").html(c.descriptionFr),1==e||""==c.imageFr?($("#location-image").attr("src","img/transparent.png"),$("#location-image").attr("style","width: 0px; height:0px;")):$("#location-image").attr("src",c.imageFr),$(".location-name").html(c.locationFr),$("#location-email").html(c.email),$(".event-date-time").html(d.currentDateFr+" | @ "+d.timeFr),$(".add-to-calendar").click(function(){var e=new Date(c.startDateTime),t=new Date(c.endDateTime),i=c.nameEn,a=c.locationEn,n=c.descriptionEn;window.plugins.calendar.createEventInteractively(i,a,n,e,t,function(e){alert("Success: "+JSON.stringify(e))},function(e){alert("Error: "+e)})})),$("#eventsList").html(""),""!=c.instagram&&$("#instagram").html('<a href="'+c.instagram+'"><i class="fa fa-instagram  contact-info-icon" aria-hidden="true"></i></a>'),""!=c.facebook&&$("#facebook").html('<a href="'+c.facebook+'"><i class="fa fa-facebook-square  contact-info-icon" aria-hidden="true"></i></a>'),""!=c.twitter&&$("#twitter").html('<a href="'+c.twitter+'"><i class="fa fa-twitter-square  contact-info-icon" aria-hidden="true"></i></a>'),$(".site-wrap").swipe({allowPageScroll:"vertical",swipe:function(e,t,i,l,s,c){"right"==t&&(window.location="details.html?cid="+a+"&scid="+n+"&listid="+r+"&pid="+o)}});var g='data-cId="'+a+'" data-scId="'+n+'" data-listId="'+r+'" data-pId="'+o+'"';$("#favorites").html('<a href="#" id="addToFavorites" onClick="addToFavorites()" '+g+'><i class="fa fa-heart contact-info-icon" aria-hidden="true"></i></a>'),$("#return-back-link").attr("href","details.html?cid="+a+"&scid="+n+"&listid="+r+"&pid="+o)}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}function b64DecodeUnicode(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function getUrlVars(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,i,a){e[i]=a});return e}function getPageName(){return document.title}$(document).ready(function(){$("#lang").val(getLanguage()),startApp(0),$("#langue-toggle").click(function(){"fr"==$("#lang").val()?($("#lang").val("en"),window.localStorage.setItem("lang","en")):($("#lang").val("fr"),window.localStorage.setItem("lang","fr")),startApp(0)})});